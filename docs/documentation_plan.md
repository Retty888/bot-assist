# План документации и контроля этапов разработки Hyperliquid Bot

## Обзор
Этот документ уточняет ранее согласованный план разработки и конкретизирует артефакты, контрольные точки и метрики качества по каждому этапу. План применяется ко всем работам, ведущим к выводу MVP бота в продакшен, и служит чек-листом для проектной и кросс-функциональных команд.

## Цели продукта и критерии готовности
| Фаза | Основные цели | Метрики готовности |
| --- | --- | --- |
| **MVP** | Автоматический парсинг сигналов и исполнение сделок в песочнице. | • ≥80% unit coverage для модулей `tradeSignalParser` и `hyperliquidTradingBot`.<br>• ≥95% корректных исполнений тестовых сигналов.<br>• Ошибка между ожидаемой и фактической ценой исполнения ≤0.75%.<br>• Документированная таблица рисков и mitigation. |
| **Расширение** | Подключение внешних источников сигналов, улучшенный риск-менеджмент. | • MTBF интеграций ≥ 7 дней.<br>• SLA ответа коннекторов ≤ 1 c при медианной нагрузке.<br>• Наличие алертинга на деградацию качества сигналов и data drift.<br>• Проведён security review и утверждён plan of record. |
| **Эксплуатация** | Полноценное продакшен-использование с реальными средствами. | • Успешные E2E тесты на staging (2 последовательных прогона).<br>• SLO доступности 99.5% с подтверждённой наблюдаемостью.<br>• Регламент откатов + runbook, подтверждённый SRE.<br>• Пройден аудит соответствия регуляторным требованиям (KYC/AML, лицензии). |

## Кросс-функциональные артефакты
- **RACI-матрица** по ключевым ролям (Product, Trading Tech, Risk, SRE, Security) — обновляется в конце каждой фазы.
- **Risk Register** с оценкой вероятности/влияния и планами снижения рисков.
- **Шаблоны**:
  - ADR (Context, Decision, Consequences, Security review).
  - Test Plan (включая smoke/regression, нагрузку, rollback-тесты).
  - Runbook и Disaster Recovery Plan (RPO/RTO, процедура отката).
- **Регуляторные артефакты**: результаты KYC/AML проверки, лицензии на провайдеров сигналов, политика хранения данных.

## Этапы работ
### 1. Сбор требований (1 неделя)
- **Доп. активности**: сессия по нефункциональным требованиям (latency, fault tolerance), согласование ограничений регуляторов и политики хранения данных.
- **Артефакты**: User Stories с приоритизацией must/should/could, протокол интервью с трейдерами, RACI-матрица v1, initial risk register.
- **Контроль качества**: покрытие ≥90% выявленных сценариев, подписи Risk/Compliance, документированы KYC/AML допущения.

### 2. Архитектура (4 рабочих дня)
- **Артефакты**: диаграммы компонентов и последовательностей, ERD, ADR, протокол security review, спецификации API/протоколов обмена, шаблон наблюдаемости.
- **Контроль качества**: утверждение архитектором и SRE, фиксация нефункциональных требований в ADR, оценка рисков с mitigation.
- **Доп. действия**: согласование требований к observability (логи, метрики, трассировки) и планирование шаблонов IaC.

### 3. Инфраструктура (5 рабочих дней)
- **Артефакты**: CI/CD пайплайн с lint/test/security-check этапами, Terraform/Helm модули, секрет-менеджмент и план ротации, окружения dev/staging, сценарий game day.
- **Контроль качества**: время сборки <10 мин, ≥95% автоматических проверок зелёные, покрытие alerting ≥80% ключевых метрик, проведён game day на восстановление.
- **Доп. действия**: статический анализ IaC, утверждение SRE и Security по доступам и секретам.

### 4. Реализация ключевых модулей (10 рабочих дней)
- **Артефакты**: TypeScript интерфейсы и JSON Schema входных/выходных контрактов, код модулей, unit-тесты, eslint/prettier отчёты, feature-flag план.
- **Контроль качества**: unit coverage ≥80%, среднее время ответа <1 c, статические проверки без критических нарушений, фичи обёрнуты флагами.
- **Доп. действия**: security linting (например, `npm audit`, `eslint-plugin-security`), документация по использованию фич-флагов.

### 5. Интеграции (5 рабочих дней)
- **Артефакты**: коннекторы к API, контрактные тесты, тестовые двойники внешних сервисов, соглашения по лимитам запросов, мониторинг качества данных.
- **Контроль качества**: успешные интеграционные тесты ≥95%, автоматическое восстановление соединений <30 c, отчёт по data drift и fallback-сценариям.
- **Доп. действия**: юридические согласования с провайдерами сигналов, stress-test лимитов API.

### 6. Тестирование (7 рабочих дней)
- **Артефакты**: полный Test Plan, regression suite, smoke-checklist, отчёт по нагрузочному тесту (например, k6), сценарии аварийного отключения, анализ логов на PII.
- **Контроль качества**: покрытие тестами ≥85%, критические дефекты устранены, MTTR по найденным багам ≤ 1 рабочий день, успешный rollback-тест.
- **Доп. действия**: автоматизация анализа логов, подготовка e2e сценариев с канареечным релизом.

### 7. Документация и деплой (4 рабочих дня)
- **Артефакты**: обновлённые README/руководства, runbook, релизные заметки, security checklist, финансовый аудит перед релизом, план канареечного/blue-green деплоя, видео/воркшоп для трейдеров и SRE.
- **Контроль качества**: документация пройдена по чек-листу, деплой без блокирующих инцидентов, подтверждённый rollback-план, финальный sign-off стейкхолдерами.
- **Доп. действия**: dry-run деплоя на staging, проверка лицензий зависимостей, подтверждение прохождения SAST/DAST.

## Временные ориентиры и зависимости
- Общая продолжительность: ~6 недель (30 рабочих дней).
- Параллельные активности: инфраструктура может начинаться во второй половине архитектуры; unit/contract тесты запускаются параллельно с реализацией.
- Буфер: 3 рабочих дня распределены — по 1 дню после реализации и интеграций, 1 день перед финальным деплоем.
- Definition of Done для перехода между этапами фиксируется в Jira и подписывается ответственными из RACI.

## Чек-лист готовности к продакшену
- [ ] Все тесты (unit/integration/e2e) автоматизированы и зелёные в CI.
- [ ] Релизная ветка прошла двойной code review и подпись релиз-менеджера.
- [ ] Настроен мониторинг latency/error rate, баланс, статус соединений, качество сигналов (включая ложные срабатывания).
- [ ] Runbook и Disaster Recovery Plan актуальны, подтверждены SRE и Risk (RPO/RTO согласованы).
- [ ] Проведён security review, проверка секретов, SAST/DAST, аудит лицензий зависимостей.
- [ ] Подтверждены SLA с поставщиками сигналов и Hyperliquid, зафиксированы юридические соглашения.
- [ ] Выполнен dry-run деплоя на staging с имитацией реальных сигналов и rollback-тестом.
- [ ] Финансовый мониторинг (PnL, fees) настроен и проверен.

## План поддержки и итераций после релиза
- Еженедельный обзор метрик качества сигналов и финансового результата, ответственные указаны в RACI.
- Регулярные (раз в 2 недели) учения по реагированию на инциденты и обновление секретов.
- Проведение blameless postmortem по инцидентам и обновление runbook.
- Поддержание roadmap исследований новых стратегий, управление feature toggles на продакшене.
- Канал обратной связи с трейдерами (Slack/Telegram) с целевым временем реакции ≤4 ч в рабочие дни.

