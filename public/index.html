<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Hyperliquid Signal Bot</title>
    <link rel="stylesheet" href="/styles.css" />
    <script
      defer
      src="https://unpkg.com/lightweight-charts@4.1.0/dist/lightweight-charts.standalone.production.js"
    ></script>
  </head>
  <body data-theme="dark">
    <main>
      <header class="hero">
        <div class="hero-actions">
          <button id="theme-toggle" class="theme-toggle" type="button" aria-label="Toggle color theme">
            <span class="theme-toggle__icon" aria-hidden="true">☀️</span>
            <span class="theme-toggle__label">Light</span>
          </button>
        </div>
        <div>
          <p class="eyebrow">Manual Signal Executor</p>
          <h1>Hyperliquid Signal Bot</h1>
          <p class="lede">
            Paste a trading signal to parse it and forward the normalized order to Hyperliquid.
            Without credentials the bot runs in demo mode with mocked clients.
          </p>
        </div>
        <aside class="runtime-hints">
          <h2>Environment</h2>
          <ul>
            <li><code>HYPERLIQUID_PRIVATE_KEY</code></li>
            <li><code>HYPERLIQUID_TESTNET</code> (default: true)</li>
            <li><code>HYPERLIQUID_SLIPPAGE_BPS</code> (optional)</li>
            <li><code>TRADING_SIGNAL</code> (optional override)</li>
          </ul>
          <h3>Signal Helpers</h3>
          <ul class="syntax">
            <li><code>trailing stop 0.5%</code> &rarr; dynamic stop offset</li>
            <li><code>grid 3 150</code> &rarr; equal ladder spacing (absolute)</li>
            <li><code>trail entry 4 0.25%</code> &rarr; geometric ladder (percent)</li>
          </ul>
        </aside>
      </header>

      <section class="card market" id="market-dashboard">
        <header class="market-header">
          <div>
            <h2>Market dashboard</h2>
            <p>Track mid price, spreads, and contextual volatility before executing.</p>
          </div>
          <div class="market-badges">
            <span id="market-mode-badge" class="badge badge--demo">Demo data</span>
            <span id="market-updated" class="badge badge--muted">—</span>
          </div>
        </header>

        <dl class="market-stats">
          <div>
            <dt>Symbol</dt>
            <dd id="market-symbol">—</dd>
          </div>
          <div>
            <dt>Mid price</dt>
            <dd id="market-mid">—</dd>
          </div>
          <div>
            <dt>Spread</dt>
            <dd id="market-spread">—</dd>
          </div>
          <div>
            <dt>Volatility</dt>
            <dd id="market-volatility">—</dd>
          </div>
          <div>
            <dt>Funding</dt>
            <dd id="market-funding">—</dd>
          </div>
          <div>
            <dt>24h volume</dt>
            <dd id="market-volume">—</dd>
          </div>
        </dl>

        <div class="chart-grid">
          <div class="chart-panel">
            <header class="chart-panel__header">
              <h3>Price action</h3>
              <p>Live candlesticks with execution layers.</p>
            </header>
            <div id="price-chart" class="chart-canvas" role="img" aria-label="Candlestick chart"></div>
            <ul id="layer-summary" class="layer-summary" aria-live="polite"></ul>
          </div>

          <div class="chart-panel heatmap-panel">
            <header class="chart-panel__header">
              <h3>Volume heatmap</h3>
              <p>Relative liquidity bands around the current mid price.</p>
            </header>
            <div id="volume-heatmap" class="heatmap-grid" role="list"></div>
            <p id="volatility-hint" class="volatility-hint">—</p>
          </div>
        </div>
      </section>

      <section class="card">
        <form id="signal-form" autocomplete="off">
          <label class="field-label" for="signal">Signal text</label>
          <textarea id="signal" name="signal" placeholder="Enter signal..." spellcheck="false"></textarea>
          <div class="hint-slot" data-hint-slot="signal" aria-live="polite"></div>

          <div class="actions">
            <button type="submit" class="primary">Execute Signal</button>
            <button type="button" id="btn-reset" class="ghost">Reset</button>
            <button type="button" id="btn-sample" class="ghost">Load sample</button>
          </div>
        </form>
      </section>

      <section class="card advanced">
        <header class="advanced-header">
          <h2>Advanced Modules</h2>
          <p>Toggle optional automation features and tailor their execution parameters.</p>
        </header>

        <div class="toggle-grid">
          <button type="button" class="toggle" data-feature="trailingStop">Trailing Stop</button>
          <button type="button" class="toggle" data-feature="grid">Grid Entries</button>
          <button type="button" class="toggle" data-feature="trailEntry">Trailing Entries</button>
        </div>

        <div id="settings-trailingStop" class="feature-settings hidden">
          <div class="settings-header">
            <div>
              <h3>Trailing Stop</h3>
              <p>Offsets the stop relative to the best filled entry.</p>
            </div>
          </div>
          <div class="field-row">
            <label for="trailing-stop-value">Offset</label>
            <div class="input-group">
              <input type="number" id="trailing-stop-value" min="0.01" step="0.01" value="0.5" />
              <select id="trailing-stop-unit">
                <option value="percent">% (percent)</option>
                <option value="absolute">Absolute</option>
                <option value="bps">bps</option>
              </select>
            </div>
          </div>
          <div class="hint-slot" data-hint-slot="trailingStop" aria-live="polite"></div>
        </div>

        <div id="settings-grid" class="feature-settings hidden">
          <div class="settings-header">
            <div>
              <h3>Grid Entries</h3>
              <p>Splits the position across evenly spaced limit orders.</p>
            </div>
          </div>
          <div class="field-row">
            <label for="grid-levels">Levels</label>
            <input type="number" id="grid-levels" min="1" max="12" step="1" value="3" />
          </div>
          <div class="field-row">
            <label for="grid-spacing-value">Spacing</label>
            <div class="input-group">
              <input type="number" id="grid-spacing-value" min="0.01" step="0.01" value="150" />
              <select id="grid-spacing-unit">
                <option value="absolute">Absolute</option>
                <option value="percent">% (percent)</option>
                <option value="bps">bps</option>
              </select>
            </div>
          </div>
          <div class="hint-slot" data-hint-slot="grid" aria-live="polite"></div>
        </div>

        <div id="settings-trailEntry" class="feature-settings hidden">
          <div class="settings-header">
            <div>
              <h3>Trailing Entries</h3>
              <p>Builds a geometric ladder to chase price with increasing offsets.</p>
            </div>
          </div>
          <div class="field-row">
            <label for="trail-entry-levels">Levels</label>
            <input type="number" id="trail-entry-levels" min="1" max="12" step="1" value="4" />
          </div>
          <div class="field-row">
            <label for="trail-entry-step-value">Step</label>
            <div class="input-group">
              <input type="number" id="trail-entry-step-value" min="0.01" step="0.01" value="0.25" />
              <select id="trail-entry-step-unit">
                <option value="percent">% (percent)</option>
                <option value="absolute">Absolute</option>
                <option value="bps">bps</option>
              </select>
            </div>
          </div>
          <div class="hint-slot" data-hint-slot="trailEntry" aria-live="polite"></div>
        </div>

        <div class="snippet-preview">
          <span>Auto append:</span>
          <code id="auto-snippet">(none)</code>
        </div>
        <p id="auto-error" class="snippet-error"></p>
      </section>

      <section class="card hints" id="hints-card">
        <header class="hints-header">
          <h2>Strategy recommendations</h2>
          <span class="hint-badge mild" data-tooltip="Contextual tips update as you tweak the signal.">beta</span>
        </header>
        <div class="hint-context-grid" id="hint-context">
          <div>
            <span class="hint-label">Symbol</span>
            <span class="hint-value" id="hint-symbol">—</span>
          </div>
          <div>
            <span class="hint-label">Price</span>
            <span class="hint-value" id="hint-price">—</span>
          </div>
          <div>
            <span class="hint-label">ATR%</span>
            <span class="hint-value" id="hint-atr">—</span>
          </div>
          <div>
            <span class="hint-label">Volatility</span>
            <span class="hint-value" id="hint-volatility">—</span>
          </div>
          <div>
            <span class="hint-label">Size</span>
            <span class="hint-value" id="hint-size">—</span>
          </div>
          <div>
            <span class="hint-label">Notional</span>
            <span class="hint-value" id="hint-notional">—</span>
          </div>
          <div>
            <span class="hint-label">Funding</span>
            <span class="hint-value" id="hint-funding">—</span>
          </div>
        </div>
        <p id="hint-status" class="hint-status">Paste a signal to pull insights.</p>
        <div id="hint-summary" class="hint-summary" aria-live="polite"></div>
      </section>

      <section class="card output" id="status-card">
        <div class="status-header">
          <h2>Status</h2>
          <span id="status-mode">Mode: &mdash;</span>
        </div>
        <div id="status-message" class="status-message">Ready when you are.</div>
        <div class="status-insights">
          <article class="status-pane" aria-live="polite">
            <h3>Risk guard</h3>
            <p id="status-risk" class="status-indicator">—</p>
            <ul id="status-risk-details" class="status-list"></ul>
          </article>
          <article class="status-pane" aria-live="polite">
            <h3>Last execution</h3>
            <dl class="status-detail">
              <div>
                <dt>Symbol</dt>
                <dd id="status-last-symbol">—</dd>
              </div>
              <div>
                <dt>Status</dt>
                <dd id="status-last-status">—</dd>
              </div>
              <div>
                <dt>PnL (proj.)</dt>
                <dd id="status-last-pnl">—</dd>
              </div>
              <div>
                <dt>Notional</dt>
                <dd id="status-last-notional">—</dd>
              </div>
              <div>
                <dt>Leverage</dt>
                <dd id="status-last-leverage">—</dd>
              </div>
            </dl>
            <p id="status-last-updated" class="status-timestamp">Updated: —</p>
          </article>
        </div>
        <details class="details" open>
          <summary>Parsed signal</summary>
          <pre id="parsed-signal">(waiting)</pre>
        </details>
        <details class="details">
          <summary>Order payload</summary>
          <pre id="order-payload">(waiting)</pre>
        </details>
        <details class="details">
          <summary>Exchange response</summary>
          <pre id="exchange-response">(waiting)</pre>
        </details>
      </section>

      <section class="card analytics" id="analytics-card">
        <header class="analytics-header">
          <div>
            <h2>Analytics</h2>
            <p>Monitor cumulative performance, win rate, and leverage utilization.</p>
          </div>
          <button id="analytics-refresh" type="button" class="ghost">Refresh</button>
        </header>
        <div class="analytics-summary" role="list">
          <div class="analytics-summary__item" role="listitem">
            <span class="analytics-summary__label">Cumulative PnL</span>
            <span id="analytics-pnl" class="analytics-summary__value">—</span>
          </div>
          <div class="analytics-summary__item" role="listitem">
            <span class="analytics-summary__label">Win rate</span>
            <span id="analytics-winrate" class="analytics-summary__value">—</span>
          </div>
          <div class="analytics-summary__item" role="listitem">
            <span class="analytics-summary__label">Avg leverage</span>
            <span id="analytics-leverage" class="analytics-summary__value">—</span>
          </div>
          <div class="analytics-summary__item" role="listitem">
            <span class="analytics-summary__label">Daily volume</span>
            <span id="analytics-volume" class="analytics-summary__value">—</span>
          </div>
        </div>
        <div id="analytics-pnl-chart" class="analytics-chart" role="img" aria-label="Cumulative PnL chart"></div>
        <div class="analytics-grid">
          <div class="analytics-table">
            <h3>Daily performance</h3>
            <table>
              <thead>
                <tr>
                  <th scope="col">Date</th>
                  <th scope="col">Trades</th>
                  <th scope="col">PnL</th>
                  <th scope="col">ROI</th>
                </tr>
              </thead>
              <tbody id="analytics-daily-body">
                <tr>
                  <td colspan="4">No data</td>
                </tr>
              </tbody>
            </table>
          </div>
          <div class="analytics-table">
            <h3>Symbol breakdown</h3>
            <table>
              <thead>
                <tr>
                  <th scope="col">Symbol</th>
                  <th scope="col">Trades</th>
                  <th scope="col">Win %</th>
                  <th scope="col">PnL</th>
                </tr>
              </thead>
              <tbody id="analytics-symbol-body">
                <tr>
                  <td colspan="4">No data</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </section>

      <footer class="footer">
        <p>
          HTTP API: <code>POST /api/execute</code>
          <small>Body: <code>{ "text": string }</code></small>
        </p>
        <p>
          Default signal endpoint: <code>GET /api/default-signal</code>
        </p>
      </footer>
    </main>

    <script type="module" src="/app.js"></script>
  </body>
</html>
